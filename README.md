
# Мотивация
У моего знакомого(далее заказчик) есть небольшая проектная компания. Он хочет в будущем вывести её на IPO. Для подготовки к сложной задаче, заказчик попросил меня создать крипто-токен, аналог акций его компании. Я как раз вникал в тему криптовалют и принял его "вызов". Позже мы сработались и я написал для него NFT коллекцию и сайт.

# Крипто-токен
Мой заказчик хотел, чтобы его токен брал комиссию при продаже. Это стимулирует держать акцию дольше и уберегает долгосрочных держателей от спекулянтов, которые хотят заработать на быстрых скачках цены вверх и вниз. При этом необходимо оставить возможность её менять от 0 до 10%.<br><br>
Для токена я выбрал сеть TON и язык TACT, потому что на тот момент знал их лучше всего. Главная проблема на этом этапе была реализовать изменяемую комиссию. Я это решил так: при отправке токенов на продажу, транзакция проходит через контракт-прослойку, в котором сохранена текущая комиссия. Таким образом изменяя комиссию в контракт-прослойке, можно менять ее при продажах.<br><br>
[Пример продажи с комиссией.](https://tonviewer.com/transaction/e605cce0988d0fde74b4a9f9f8c084d94688af93daac1c8c8e4cf9709c5382ba)<br>
В данном примере видно, что с кошелька "[B](https://tonviewer.com/EQAVJ-ULEh5jzeSkFs3gw0xXkCers2wacGau840AW_WuPfQf)" отправляется транзакция на контракт "[C](https://tonviewer.com/EQAKwGt6wEK6zvoBRVp0UDygtcCZe_nrI_VAG9ktBeqhsF3b)", а потом обратно на "B". В контракте "С" и записана комиссия на продажу.<br><br>
Я рад, что смог выполнить нетривиальную задачу со столь небольшим удорожанием транзакции (на 0.03$).<br><br>
Ссылки:
+ [адрес токена](https://tonviewer.com/EQB4bnS7oHHVfHUAS7Qb-Xjqc-ALA_Pz-_K3PqBCb5fW6XIP)
+ [код токена](https://tonviewer.com/EQB4bnS7oHHVfHUAS7Qb-Xjqc-ALA_Pz-_K3PqBCb5fW6XIP?section=code)
  <br>
# NFT
По ТЗ необходимо создать возможность "запаковывать" и "распаковывать" токены в NFT.<br>
Я использовал сеть TON и язык TACT.<br>
Реализация "запаковки":
1. Пользователь отправляет токены на контракт.
2. Контракт создает NFT с записанным количеством токенов, которое отправил пользователь.
3. Контракт передает права на NFT пользователю.

Реализация "распаковки":
1. Пользователь передает права на NFT контракту.
2. Контракт отправляет записанное в NFT количество токенов пользователю.
3. Контракт уничтожает NFT.

Ссылки:<br>
+ [адрес NFT коллекции](https://tonviewer.com/EQDhO_YVxvb3p68hqte0kNG5jdO44WQFgWdCe8GvgVkrws4Z)
+ [код NFT коллекции](https://tonviewer.com/EQDhO_YVxvb3p68hqte0kNG5jdO44WQFgWdCe8GvgVkrws4Z?section=code)
+ [Пример "запаковывающей" транзакции.](https://tonviewer.com/transaction/1dda04be37d89d9fc9ddb452e94ea391d096f6840a20a0dcefc6a5dc863cce5d)
+ [Пример "распаковывающей" транзакции.](https://tonviewer.com/transaction/305f2695c3eb2c609f589aefd4a445eed44274dde694f94798fba17d6ce2dcfe)

# Сайт
Заказчик считает, что для плавного погружения пользователей в мир криптовалют необходимо им рассказать о базовых вещах: 'Как создать крипто-кошелек?', 'Как купить крипто-токен?', 'Как его продать?'.<br>
Ответить на эти вопросы нужно в своем miniapp в Telegram. Заказчик также попросил добавить:<br>
+ немного информации о Telegram каналах токена и его компании
+ отображение баланса кошелька
+ больше способов покупки (покупка через кошелек авторов и переводом на карту, а также, в будущем через СБП)
а

Я использовал базовый комплект web-разработчика: HTML, CSS, Javascript. Сложностей не возникало. Самая интересная часть - это работа с библиотекой TonConnect, которая позволяет подключать крипто-кошельки к сайту и упрощает отправку транзакций в блокчейн.<br>
Самый удобный способ посмотреть на сайт - это <a href="https://t.me/BIPapp_bot/app">miniapp</a> в Telegram, но можно и через <a href="https://app.biptoken.xyz?tg_mode=true&wallet_connect=true">браузер</a>.<br><br>
Информацию о разработчике можно узнать здесь: https://biptoken.xyz/authors.json , среди прочего есть ссылка на этот Github.

# API 
Для корректной работы сайта необходим API сервис.<br>
Я выбрал язык Python и библиотеку FastAPI, т.к. сервис пока не планируется высоконагруженным, максимум - 1-2 RPS, а так-же важна скорость разработки. FastAPI подошел лучше всего.<br>
Через API сайт получает цену токенов и отдает информацию о Telegram User.<br><br>
В моем случае, он также используется для определения картинки для NFT, по количеству токенов "запакованных" в ней.<br>
Каждая NFT содержит ссылку на свою meta информацию. Пример: <https://nft.biptoken.xyz/CreateItemMetadata?value=4242>, при создании NFT в поле value передается количество токенов, которое она "содержит".<br>
В поле "image" возвращается нужная ссылка на изображение.<br>

[Документация к API](https://api.biptoken.xyz/docs)

# Итог
#### Я написал комиссионный крипто-токен, создал NFT коллекцию и сайт для него. <br>Заказчик остался доволен, а я получил необходимый опыт.
